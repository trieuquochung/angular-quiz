import{$ as a,Qc as d,W as o,a as r,b as n,hc as s,pa as c}from"./chunk-SXMPOHV7.js";var l=class u{firebaseService=a(d);state=c({currentQuestionIndex:0,questions:[],userAnswers:new Map});currentQuestion=s(()=>{let e=this.state().questions,t=this.state().currentQuestionIndex;return e[t]});progress=s(()=>{let e=this.state().questions.length;return e?(this.state().currentQuestionIndex+1)/e*100:0});isLastQuestion=s(()=>this.state().currentQuestionIndex===this.state().questions.length-1);questions=s(()=>this.state().questions);currentIndex=s(()=>this.state().currentQuestionIndex);userAnswers=s(()=>this.state().userAnswers);loadQuestions(){console.warn("loadQuestions() is deprecated. Use setQuestions() instead.")}setQuestions(e){this.state.update(t=>n(r({},t),{questions:e,currentQuestionIndex:0,userAnswers:new Map}))}submitAnswer(e){let t=this.currentQuestion();t&&this.state.update(i=>n(r({},i),{userAnswers:new Map(i.userAnswers).set(String(t.id),e)}))}nextQuestion(){this.isLastQuestion()||this.state.update(e=>n(r({},e),{currentQuestionIndex:e.currentQuestionIndex+1}))}getResults(){let e=this.state();return e.questions.map(t=>({question:t.question,userAnswer:e.userAnswers.get(String(t.id))??"Not answered",correctAnswer:t.correctAnswer,isCorrect:e.userAnswers.get(String(t.id))===t.correctAnswer}))}getScore(){let e=this.getResults();return{score:e.filter(t=>t.isCorrect).length,total:e.length}}resetQuiz(){this.state.update(e=>n(r({},e),{currentQuestionIndex:0,userAnswers:new Map}))}saveResults(){let e=this.getResults(),{score:t,total:i}=this.getScore();this.firebaseService.saveQuizResult(e,t,i).subscribe(g=>{console.log("Quiz results saved with session ID:",g)})}static \u0275fac=function(t){return new(t||u)};static \u0275prov=o({token:u,factory:u.\u0275fac,providedIn:"root"})};export{l as a};
